# AWS機械学習関連用語解説

## Amazon SageMaker Pipelines を使用します。モデルのバージョンが登録されたら、AWS SDK を使用して放任ステータスを「承認済み(Approved)に変更します。
SageMaker Pipelinesでモデル登録後に自動承認するワークフローです。モデルレジストリでのバージョン管理と承認プロセスを自動化し、本番環境へのデプロイを効率化します。

**主な特徴:**
- モデルバージョンの自動登録と追跡
- プログラムによる承認ステータスの変更
- CI/CD パイプラインとの統合
- モデルメタデータとアーティファクトの管理
- 承認ワークフローの自動化
- デプロイプロセスのトリガー

**実装ステップ:**
1. SageMaker Pipeline でモデルトレーニングと評価を実行
2. 評価メトリクスに基づく条件ステップでモデル品質を検証
3. RegisterModel ステップでモデルをモデルレジストリに登録
4. AWS SDK（boto3）を使用してモデルステータスを更新:
   ```python
   client = boto3.client('sagemaker')
   client.update_model_package(
       ModelPackageArn='model_package_arn',
       ModelApprovalStatus='Approved'
   )
   ```
5. 承認済みモデルの自動デプロイを設定（オプション）

**ユースケース:**
- 継続的インテグレーション/継続的デプロイ（CI/CD）パイプライン
- 品質基準を満たすモデルの自動昇格
- モデル開発から本番環境までの自動化
- 規制要件に準拠したモデル承認プロセス
- A/B テストのための複数モデルバージョンの管理
- モデルガバナンスとコンプライアンスの強化

## ワンホットエンコーディング
カテゴリ変数を数値形式に変換する手法で、各カテゴリを二値ベクトル（0と1）で表現します。機械学習アルゴリズムがカテゴリデータを処理できるようにします。

**主な特徴:**
- カテゴリごとに新しい二値特徴（0または1）を作成
- 順序関係を持たないカテゴリに最適
- 特徴空間の次元を増加させる
- カテゴリ間の距離を均等に保つ
- 多くの ML アルゴリズムとの互換性

**実装方法:**
- SageMaker Processing ジョブでの前処理
- scikit-learn の OneHotEncoder
- pandas の get_dummies 関数
- TensorFlow や PyTorch の組み込み関数
- AWS Glue や SageMaker Data Wrangler での変換

**考慮事項:**
- 高基数カテゴリ（多数の一意値）での次元爆発
- スパースマトリックス表現の必要性
- メモリ使用量と計算コスト
- 未知のカテゴリの処理方法
- 特徴選択との組み合わせ

**ユースケース:**
- 線形モデル（線形回帰、ロジスティック回帰）での使用
- ニューラルネットワークの入力層
- 決定木ベースのアルゴリズムでの特徴表現
- 地域、製品カテゴリ、色などの名目変数の変換
- 多クラス分類問題の出力エンコーディング

## ターゲットエンコーディング
カテゴリ変数をターゲット変数の平均値に置き換えるエンコーディング手法です。カテゴリと目的変数の関係を直接モデルに取り込むことができます。

**主な特徴:**
- 各カテゴリをターゲット変数の条件付き平均で置換
- 高基数カテゴリの効率的な処理
- 次元の爆発を防止
- カテゴリ間の関係性を保持
- 過学習のリスクを軽減するための正則化オプション

**実装方法:**
- クロスバリデーションによるターゲットエンコーディング
- スムージング（平滑化）技術の適用
- scikit-learn の contrib モジュールや category_encoders ライブラリ
- カスタム実装（SageMaker Processing ジョブなど）
- AWS Glue ETL ジョブでのカスタム変換

**バリエーション:**
- Leave-One-Out エンコーディング
- M-推定量によるスムージング
- ベイジアンターゲットエンコーディング
- 重み付き平均アプローチ
- 時系列データ用の時間ベースの分割

**ユースケース:**
- 高基数カテゴリ変数（郵便番号、製品ID など）の処理
- クリックスルー率（CTR）予測
- 顧客行動モデリング
- リスクスコアリング
- 推薦システム

## レベルエンコーディング
カテゴリ変数を整数値に変換するエンコーディング手法です。各カテゴリに一意の整数を割り当てます。順序関係がある場合に特に有用です。

**主な特徴:**
- 各カテゴリを一意の整数値にマッピング
- 元のカテゴリ数と同じ次元数を維持
- メモリ効率が良い
- 順序カテゴリに適している
- 実装が簡単

**実装方法:**
- scikit-learn の LabelEncoder
- pandas の factorize 関数
- カスタムマッピング辞書の作成
- SageMaker の組み込み変換
- AWS Glue の StringToNumber 変換

**考慮事項:**
- 順序関係のないカテゴリでの誤った数値関係の導入
- 未知のカテゴリの処理
- エンコーディングの一貫性の維持
- スケーリングの必要性
- モデル解釈への影響

**ユースケース:**
- 順序カテゴリ（小、中、大など）のエンコーディング
- 決定木ベースのアルゴリズム（ランダムフォレスト、XGBoost など）
- メモリ制約のある環境
- 前処理パイプラインの簡素化
- テキスト処理での単語インデックス作成

## バランスデータ
クラス間のサンプル数の不均衡を是正したデータセットです。機械学習モデルが少数クラスを適切に学習できるようにします。

**主な特徴:**
- クラス分布の均等化または制御
- 少数クラスの表現向上
- モデルバイアスの軽減
- 評価メトリクスの信頼性向上
- 少数クラスの予測精度の改善

**バランシング手法:**
1. **アンダーサンプリング**:
   - ランダムアンダーサンプリング
   - クラスタリングベースのアンダーサンプリング
   - Tomek リンクの除去
   - 近傍クリーニングルール（NCR）

2. **オーバーサンプリング**:
   - ランダムオーバーサンプリング
   - SMOTE（Synthetic Minority Over-sampling Technique）
   - ADASYN（Adaptive Synthetic Sampling）
   - ボーダーラインSMOTE

3. **ハイブリッド手法**:
   - SMOTETomek
   - SMOTEENN
   - バランスドバギング
   - バランスドランダムフォレスト

**実装ツール:**
- imbalanced-learn ライブラリ
- SageMaker の組み込みアルゴリズム（XGBoost のクラス重み付けなど）
- カスタム重み付けとコスト敏感学習
- SageMaker Processing ジョブでのデータ前処理
- AWS Glue ETL ジョブでのデータ変換

**ユースケース:**
- 不正検知（少数の不正トランザクション）
- 医療診断（希少疾患の検出）
- 顧客解約予測（少数の解約顧客）
- 製造での欠陥検出（少数の不良品）
- 異常検知（少数の異常イベント）
- リスク管理（少数の高リスクケース）
